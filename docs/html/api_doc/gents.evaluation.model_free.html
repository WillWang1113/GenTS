

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>gents.evaluation.model_free package &mdash; GenTS 0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=2709fde1"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="gents.evaluation.visualization package" href="gents.evaluation.visualization.html" />
    <link rel="prev" title="gents.evaluation.model_based package" href="gents.evaluation.model_based.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            GenTS
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Get started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../get_started/install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../get_started/quick_start.html">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="../get_started/available_models.html">Available Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../get_started/available_datasets.html">Available Datasets</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/time_series_forecasting.html">Time Series Forecasting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/missing_value_imputation.html">Time Series Imputation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/synthesis_with_irregular_data.html">Time Series Synthesis with Irregular Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/class_label_guidance.html">Time Series Generation with Class Label Guidance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/customization.html">How to build your own time series model/dataset?</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API docs</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">gents</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="gents.html">gents package</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="gents.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="gents.common.html">gents.common package</a></li>
<li class="toctree-l4"><a class="reference internal" href="gents.dataset.html">gents.dataset package</a></li>
<li class="toctree-l4 current"><a class="reference internal" href="gents.evaluation.html">gents.evaluation package</a></li>
<li class="toctree-l4"><a class="reference internal" href="gents.model.html">gents.model package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="gents.html#module-gents">Module contents</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">GenTS</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="modules.html">gents</a></li>
          <li class="breadcrumb-item"><a href="gents.html">gents package</a></li>
          <li class="breadcrumb-item"><a href="gents.evaluation.html">gents.evaluation package</a></li>
      <li class="breadcrumb-item active">gents.evaluation.model_free package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/api_doc/gents.evaluation.model_free.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="gents-evaluation-model-free-package">
<h1>gents.evaluation.model_free package<a class="headerlink" href="#gents-evaluation-model-free-package" title="Link to this heading"></a></h1>
<section id="module-gents.evaluation.model_free">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-gents.evaluation.model_free" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="gents.evaluation.model_free.WassersteinDistances">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gents.evaluation.model_free.</span></span><span class="sig-name descname"><span class="pre">WassersteinDistances</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">original_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">other_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalisation</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'none'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gents.evaluation.model_free.WassersteinDistances" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Calculate Wasserstein distance of two datasets in various ways. Addapted form <a class="reference external" href="https://gitlab.developers.cam.ac.uk/maths/cia/covid-19-projects/missing_data_fitting_quality">https://gitlab.developers.cam.ac.uk/maths/cia/covid-19-projects/missing_data_fitting_quality</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>original_data</strong> (<em>np.ndarray</em>) – Original data set, an (n, d) ndarray.</p></li>
<li><p><strong>other_data</strong> (<em>np.ndarray</em>) – Other data set, which might be imputed or simulated data, also an (n, d) ndarray.</p></li>
<li><p><strong>normalisation</strong> (<em>str</em>) – Normalisation. Method of normalising data.  If ‘none’, no normalisation will be used. If ‘standatdise’, then standardise the data by dividing by the standard deviation of the original data.  (There is no need to subtract the mean, as this does not affect the Wasserstein distance.). Defaults to <cite>None</cite>.</p></li>
<li><p><strong>seed</strong> (<em>int</em>) – Random seed. Defaults to <cite>None</cite></p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="gents.evaluation.model_free.WassersteinDistances.directional_distance">
<span class="sig-name descname"><span class="pre">directional_distance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">direction</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="headerlink" href="#gents.evaluation.model_free.WassersteinDistances.directional_distance" title="Link to this definition"></a></dt>
<dd><p>Calculate the dataset distance in a specified direction.</p>
<p>This projects the two datasets onto the specified direction (that is,
a 1-dimensional subspace), and calculates the Wasserstein distance
between the two resulting distributions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>direction</strong> (<em>np.array</em>) – The direction in which to calculate the W_2 distance between
the datasets.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>distance</strong> – The calculated W_2^2 distance.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gents.evaluation.model_free.WassersteinDistances.feature_distance">
<span class="sig-name descname"><span class="pre">feature_distance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feature</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="headerlink" href="#gents.evaluation.model_free.WassersteinDistances.feature_distance" title="Link to this definition"></a></dt>
<dd><p>Calculate the dataset distance for a specific feature.</p>
<p>This calculates the Wasserstein 2-distance between the
specified feature in the two datasets.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>feature</strong> (<em>int</em>) – The column number of the feature to consider: 0, 1, 2, …,
<cite>num_fields</cite> - 1.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>distance</strong> – The Wasserstein 2-distance.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gents.evaluation.model_free.WassersteinDistances.get_marginal_directions">
<span class="sig-name descname"><span class="pre">get_marginal_directions</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#gents.evaluation.model_free.WassersteinDistances.get_marginal_directions" title="Link to this definition"></a></dt>
<dd><p>Get marginal directions for an experiment.</p>
<p>These are just the standard basis vectors.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>directions</strong> – A list of standard unit vectors.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>list[np.ndarray]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gents.evaluation.model_free.WassersteinDistances.get_random_directions">
<span class="sig-name descname"><span class="pre">get_random_directions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_directions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#gents.evaluation.model_free.WassersteinDistances.get_random_directions" title="Link to this definition"></a></dt>
<dd><p>Get random directions for an experiment.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>n_directions</strong> (<em>int</em>) – The number of directions to produce.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>directions</strong> – A list of unit vectors specifying the directions to use.  The
results will be given in the same order.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list[np.ndarray]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gents.evaluation.model_free.WassersteinDistances.marginal_distances">
<span class="sig-name descname"><span class="pre">marginal_distances</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="headerlink" href="#gents.evaluation.model_free.WassersteinDistances.marginal_distances" title="Link to this definition"></a></dt>
<dd><p>Calculate the marginal Wasserstein distances between datasets.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>distribution of Wasserstein distances over all features.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gents.evaluation.model_free.WassersteinDistances.random_direction">
<span class="sig-name descname"><span class="pre">random_direction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="headerlink" href="#gents.evaluation.model_free.WassersteinDistances.random_direction" title="Link to this definition"></a></dt>
<dd><p>Generate a unit vector in a random direction.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dim</strong> (<em>int</em>) – Dimension of vector to be generated.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>unit_vector</strong> – A unit vector of shape (dim,).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gents.evaluation.model_free.WassersteinDistances.sliced_distances">
<span class="sig-name descname"><span class="pre">sliced_distances</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_directions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="headerlink" href="#gents.evaluation.model_free.WassersteinDistances.sliced_distances" title="Link to this definition"></a></dt>
<dd><p>Calculate the sliced Wasserstein distance between datasets.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>num_directions</strong> (<em>int</em>) – Number of directions in the sliced Wasserstein estimation.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>distribution of Wasserstein distances over all directions.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gents.evaluation.model_free.crps">
<span class="sig-prename descclassname"><span class="pre">gents.evaluation.model_free.</span></span><span class="sig-name descname"><span class="pre">crps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_true</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_pred</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quantiles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([0.1,</span> <span class="pre">0.2,</span> <span class="pre">0.3,</span> <span class="pre">0.4,</span> <span class="pre">0.5,</span> <span class="pre">0.6,</span> <span class="pre">0.7,</span> <span class="pre">0.8,</span> <span class="pre">0.9])</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="headerlink" href="#gents.evaluation.model_free.crps" title="Link to this definition"></a></dt>
<dd><p>Calculating continuous ranked probability score (CRPS) through Multi-Quantile loss.</p>
<p>Adapated from <cite>neuralforecast.losses.numpy</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y_true</strong> (<em>np.ndarray</em>) – Ground truth time series, in shape of <cite>[B, T, C]</cite></p></li>
<li><p><strong>y_pred</strong> (<em>np.ndarray</em>) – Predicted time series scenarios, in shape of <cite>[B, T, C, N]</cite> (<cite>N</cite> is the number of scenarios), or <cite>[B, T, C, Q]</cite> (<cite>Q</cite> is the number of quantiles).</p></li>
<li><p><strong>quantiles</strong> (<em>np.array</em><em>, </em><em>optional</em>) – Quantile levels. The more levels are, the more accurately CRPS is approximated. Defaults to np.arange(0.1, 1.0, 0.1).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="gents.evaluation.model_free.mse">
<span class="sig-prename descclassname"><span class="pre">gents.evaluation.model_free.</span></span><span class="sig-name descname"><span class="pre">mse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_true</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_pred</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="headerlink" href="#gents.evaluation.model_free.mse" title="Link to this definition"></a></dt>
<dd><p>Calculating Mean Squared Error (MSE).</p>
<p>Adapated from <cite>sklearn.metrics.mean_squared_error</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y_true</strong> (<em>np.ndarray</em>) – Ground truth time series, in shape of <cite>[B, T, C]</cite>.</p></li>
<li><p><strong>y_pred</strong> (<em>np.ndarray</em>) – Predicted time series scenarios, in shape of <cite>[B, T, C]</cite>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="gents.evaluation.model_based.html" class="btn btn-neutral float-left" title="gents.evaluation.model_based package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="gents.evaluation.visualization.html" class="btn btn-neutral float-right" title="gents.evaluation.visualization package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Chenxi Wang.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>